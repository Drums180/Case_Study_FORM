---
title: "Form-Deliverable2"
author: "David Dominguez - A01570975, Alejandra Suárez - A00835247, Daniel Nájera - A01709578, Eduardo Camacho - A01026437, Gabriel Medina - A01275763"
date: "2024-03-13"
output: 
  html_document:
    toc: TRUE
    toc_float: TRUE
    code_download: TRUE
    theme: cosmo
---

![FORM BANNER](/Users/daviddrums180/Tec/Case_Study_Form/src/form.jpg)

CD2001C -- Analítica para Negocios: De Los Datos a las Decisiones Febrero -- Junio 2024

# Entregable 2 -- Evidencia 1

## Situación Problema 1: Rotación de Personal

Explorar, definir, y describir cuáles son los principales factores del clima organizacional de FORM que propician la satisfacción y/o no satisfacción de trabajar en dicha empresa.

La rotación de personal se ha identificado como el desafío más crítico que enfrenta FORM en el presente. A pesar de nuestros esfuerzos continuos para crear un ambiente laboral atractivo y retener a nuestros valiosos empleados, nos encontramos con una tasa de rotación especialmente alta entre los operadores. Este fenómeno no solo afecta la continuidad y la eficiencia de nuestras operaciones, sino que también incrementa los costos asociados con el reclutamiento y la capacitación de nuevo personal.

-   **Principales Puntos:**
    -   La estabilidad familiar y las condiciones laborales son factores significativos que influyen en la decisión de los empleados de permanecer en la empresa.
    -   Los jóvenes, especialmente aquellos sin compromisos familiares, tienden a buscar oportunidades de desarrollo profesional fuera de FORM.
    -   Es crucial mejorar nuestras estrategias de reclutamiento y retención para abordar las causas subyacentes de la rotación de personal.

## Situación Problema 2: Predicción de Demanda

Explorar, desarrollar, y describir la(s) posible(s) estrategia(s) de predicción de la demanada de productos fabricados por la empresa FORM.

La predicción precisa de la demanda representa un desafío igualmente significativo para FORM, dada la variabilidad inherente en la producción y venta de autopartes. La habilidad para anticipar con exactitud cuántas unidades de un determinado componente serán necesarias es crucial para optimizar nuestros procesos de producción y empaque, y para asegurar que se maximice la eficiencia en el uso de recursos.

-   **Principales Puntos:**
    -   La naturaleza fluctuante de la demanda automotriz complica la planificación y gestión de inventarios.
    -   Es esencial desarrollar herramientas y procesos más sofisticados para mejorar la precisión en nuestras predicciones de demanda.
    -   La adaptabilidad y la capacidad de responder rápidamente a los cambios en el mercado son fundamentales para mantener nuestra competitividad.

## Análisis Descriptivo de los Datos

A partir de las diferentes bases de datos compartidas por la empresa FORM y las industrias relacionadas con dicha empresa, seleccionar al menos 1 situación problema y elaborar lo siguiente:

### Preguntas de Análisis

Elaborar 4-6 preguntas relacionadas con la situación problema seleccionada que se puedan responder mediante el análisis de datos.

Preguntas RRHH

¿Qué está causando la rotación de personal tan alta?
¿Existe algún momento del año donde se den más bajas dentro de la empresa?
¿Cómo se siente la gente dentro de su trabajo actual?
¿Qué factor ayuda a que el personal dure más tiempo dentro de la empresa?
¿En qué parte de la empresa el trabajador se siente más inconforme y cuál es su perfil?

## Pronosticos y Nearshoring

¿Cómo es el posible impacto del Nearshoring sobre la Empresa FORM?

-   Mediante el uso de visualización de datos describir el posible impacto del fenómeno nearshoring sobre el desempeño de la empresa FORM.

-   Pronosticar el evento de Nearshoring.

-   Pronosticar el desempeño de FORM.

## Diseño, Organización, y Limpieza de Base de Datos

-   Seleccionar información y datos que consideren relevantes para responder las preguntas de análisis.

-   Diseñar y organizar base(s) de datos a partir de la información y datos seleccionados.

-   Visualizar en R los primeros 6 renglones de la nueva base de datos.

-   Elaborar glosario de las variables que se incluyen en la nueva base de datos.

## Análisis Exploratorio de los Datos (EDA)

-   Desarrollar EDA que responda cada una de las preguntas de análisis.

-   Considerar los siguientes elementos en el desarrollo de EDA para responder las preguntas de análsis:

-   **a. Estadísticos Descriptivos**

-   **b. Medidas de Dispersión**

-   **c. 4-6 Gráficos (barras, líneas, pastel, dispersión, burbujas, correlación, mapas)**

-   **d. Tablas (frequencia, contingencia)**

-   **e. Pronóstico de ventas (e.g., unidades de producción, ventas en \$)**

-   **Interpretación** Interpretar los hallazgos identificados en el desarrollo de EDA para responder las preguntas de análisis.

## Búsqueda de información y datos

-   ¿Qué tipo de información / datos solicitarías al socio formador para mejorar EDA? soluciones efectivas a los problemas de la empresa, principalmente en la rotación de personal y la predicción de la demanda en producción es por eso que pediríamos información como:

Para poder tener un Análisis Exploratorio de los Datos completo, debemos de desarrollar soluciones efectivas a los problemas de la empresa, principalmente en la rotación de personal y la predicción de la demanda en producción es por eso que pediríamos información como:

1.  Información detallada sobre las bases de datos, como base de datos completa de personal. También, en la base de datos de ventas incluir más información, ya que cuenta con NA, lo que hace complicaciones en el análisis, que no podamos trabajar con muy pocos datos y eso limita nuestro trabajo para poder seguir identificando hallazgos importantes para la empresa

2.  Data de encuestas de bajas, sobre todo incluyendo las razones de la renuncia para poder detectar diferentes tendencias y patrones.

3.  Un Análisis Demográfico para saber datos de la edad, género, situación familiar y ubicación geográfica de los empleados para poder relacionar patrones con la rotación que existe en FORM.

De forma más simple, los datos explicitos más necesarios son: 
-⁠ **⁠BASE DATOS COMPLETA DE PERSONAL**
-⁠ **⁠DATA DE ENCUESTAS DE RAZON DE BAJAS**
-⁠ **⁠DATA DE TIEMPOS DE INVENTARIO**
-⁠ **⁠DATA DE DESGLOSE DE VENTA DE UNIDADES POR CLIENTE / O POR TIPO DE PARTE**

-   ¿Qué tipo de información / datos de fuentes secundarias buscarías para mejorar EDA?

Para complementar el EDA, con información de fuentes externas, buscamos información en:

1.  Informes de la Industria (Statista) debido a que nos proporciona estadísticas globales sobre la industria automotriz. incluyendo las tendencias tecnológicas.

2.  Estudios sobre el mercado de los empaques (Smithers) publican análisis de tendencias e informes de mercado de los empaques que se utilizan en el sector automotriz.

3.  Datos de Comercio Internacional y económicos (Banco Mundial) para los datos de tarifas y economía global que afectan el comercio de los empaques

4.  (Hoovers) para un Análisis de Competencia, donde se ofrecen datos importantes sobre las empresas y un análisis detallado de competidores en la industria de empaques.

-   (Opcional) Buscar información / datos de fuentes secundarias (por ejemplo, INEGI, Industria Nacional de Autopartes, etc.) que contribuyan a mejorar EDA y la identificación de hallazgos releventes que respondan las preguntas de análisis. Citar las fuentes secundarias seleccionadas.

Para tener un análisis más detallado buscamos información en diferentes fuentes:

**1.**  Crecimiento del Sector Automotriz, en el 2024 se espera que la cifra de vehículos comercializados en México incremente en un 8% y esto representa 100 mil unidades más que en el 2023. En 2023 tuvo un crecimiento del 24.4% en vehículos comercializados comparado con el 2022. (Mexico Industry, 2024). Estos datos son un potencial aumento de demanda en los empaques de autopartes lo que es un impacto positivo para FORM.

**2.**  Impacto en la electromovilidad, ya que existe una transición hacia la electromovilidad y esto genera una oportunidad para la creación de empleos y la demanda de competencias especializadas, esto impacta e influye de manera significativa a la demanda de empaques para los autopartes y componentes electrónicos y sistemas avanzados en los automóviles.


#Librerías
```{r message=FALSE, warning=FALSE}
library(readxl)
library(dplyr)
library(ggplot2)
library(psych)
library(tidyr)
```


## Importando base de datos
```{r}
datos <- read_excel("C:\\Users\\suare\\Downloads\\Encuesta_Datos_FORM_Fall2023.xlsx")
```

# **Análisis Exploratorio de los Datos**
```{r message=FALSE, warning=FALSE}
datos_num <- datos
datos_num[sapply(datos_num, is.factor)] <- lapply(datos_num[sapply(datos_num, is.factor)], as.numeric)
```

## Estructura de la base de datos
```{r message=FALSE, warning=FALSE}
str(datos_num)
```

## Medidas Descriptivas
```{r message=FALSE, warning=FALSE}
summary(datos_num)
```

```{r message=FALSE, warning=FALSE}
describe(datos_num)
```

# Medidas de Dispersión

## Cálculo de medidas de dispersión para cada variable numérica relevante
```{r message=FALSE, warning=FALSE}
sapply(datos_num, var, na.rm = TRUE)  # Varianza
sapply(datos_num, sd, na.rm = TRUE)   # Desviación estándar
```

## Cálculo del rango intercuartílico para cada variable numérica relevante
```{r message=FALSE, warning=FALSE}
sapply(datos_num, IQR, na.rm = TRUE)
```

## **Relación entre el Nivel de Estrés y Puesto de Trabajo**
```{r message=FALSE, warning=FALSE}
ggplot(datos, aes(x = reorder(puesto, estres_bajo, FUN = median), y = estres_bajo)) +
  geom_bar(stat = "summary", fun = "median", fill = "orange", color = "black") +
  coord_flip() +  # Invertir ejes para tener los puestos en el eje y y las barras extendiéndose horizontalmente
  theme_minimal() +
  labs(title = "Nivel de Estrés Mediano por Puesto de Trabajo",
       y = "Nivel de Estrés Mediano",
       x = "Puesto") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

## **Relación entre la Antigüedad y el Salario**

```{r message=FALSE, warning=FALSE}
antiguedad_por_salario <- datos %>%
  group_by(salario_bueno) %>%
  summarise(antiguedad_promedio = mean(antiguedad, na.rm = TRUE)) %>%
  arrange(desc(antiguedad_promedio))

# Definir una paleta de colores personalizada
colores_personalizados <- c('Totalmente de acuerdo' = '#AED6F1', # Claro
                            'Medianamente de acuerdo' = '#5DADE2', # Intermedio claro
                            'Ni de acuerdo ni en desacuerdo' = '#3498DB', # Neutro
                            'Medianamente en desacuerdo' = '#2874A6', # Intermedio oscuro
                            'Totalmente en desacuerdo' = '#1B4F72') # Oscuro

# Gráfico de barras de la antigüedad promedio por satisfacción con el salario, usando colores personalizados
ggplot(antiguedad_por_salario, aes(x = salario_bueno, y = antiguedad_promedio, fill = salario_bueno)) +
  geom_bar(stat = "identity") +
  scale_fill_manual(values = colores_personalizados) + # Usa la paleta de colores personalizada
  coord_flip() +
  theme_minimal() +
  labs(title = "Antigüedad Promedio por Satisfacción con el Salario",
       x = "Satisfacción con el Salario",
       y = "Antigüedad Promedio (años)"
```


## **Percepción de Molestia por la Temperatura por Puesto**

```{r message=FALSE, warning=FALSE}
datos %>%
  group_by(puesto, no_molestia_temperatura) %>%
  summarise(count = n()) %>%
  ggplot(aes(x = puesto, y = count, fill = no_molestia_temperatura)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(title = "Percepción de Molestia por la Temperatura por Puesto",
       x = "Puesto",
       y = "Cantidad",
       fill = "No Molesta la Temperatura") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

vemsop una clara molestia con la temperatura de parte de los ayudantes generales, por lo que se tiene que hacer algo para regular la temperatura dentro del espacio donde se desenvuelven estos, pues no vemos una descontento tan grande dentro de las otras areas.

## **Disconformidad por Puesto** 

```{r message=FALSE, warning=FALSE}
datos %>% 
  group_by(puesto, permanencia_form_futuro) %>% 
  summarise(count = n()) %>%
  filter(permanencia_form_futuro != "Totalmente de acuerdo" & permanencia_form_futuro != "Medianamente de acuerdo") %>%
  ggplot(aes(x = reorder(puesto, -count), y = count, fill = permanencia_form_futuro)) +
  geom_bar(stat = "identity") +
  coord_flip() +
  labs(title = "Disconformidad por Puesto",
       x = "Puesto",
       y = "Cantidad de Disconformidad") +
  theme_minimal()
```


##  **Percepción del Estrés por Rangos de Antigüedad**

```{r message=FALSE, warning=FALSE}
datos$antiguedad_rango <- cut(datos$antiguedad, breaks = seq(0, max(datos$antiguedad, na.rm = TRUE) + 5, by = 5), right = FALSE, labels = paste(seq(0, max(datos$antiguedad, na.rm = TRUE), by = 5), seq(5, max(datos$antiguedad, na.rm = TRUE) + 5, by = 5) - 1, sep = "-"))
```

```{r message=FALSE, warning=FALSE}
datos %>%
  group_by(antiguedad_rango, estres_bajo) %>%
  summarise(count = n()) %>%
  ggplot(aes(x = antiguedad_rango, y = count, fill = estres_bajo)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(title = "Percepción del Estrés por Rangos de Antigüedad",
       x = "Rango de Antigüedad",
       y = "Cantidad",
       fill = "Percepción de Bajo Estrés") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

Tenemos un buen indicar de que el estrés no es algo que esté afectando a los trabajadores, pues vemos que la mayoría, independientemente del rango de antiguedad con el que cuentan, considera tener un estrés bajo dentro de las actividades dentro de la empresa.

##  **Percepción de Prestaciones por Puesto**

```{r message=FALSE, warning=FALSE}
datos %>%
  group_by(puesto, prestaciones_bueno) %>%
  summarise(count = n()) %>%
  ggplot(aes(x = puesto, y = count, fill = prestaciones_bueno)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(title = "Percepción de Prestaciones por Puesto",
       x = "Puesto",
       y = "Cantidad",
       fill = "Hay Buenas Prestaciones") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

Podemos observar que dentro de los ayudantes genrales es donde existe una mayor cantidad de datos, pues es de donde hay mas gente, existen opiniones divididas para de si hay buenas prestaciones o no para la empresa. Esto sin duda nos hace entender que no se encuentran conformes con la sprestaciones que les está brindando la empresa, ya que si fuera así, no se tendría este comportamiento de los datos.

Se puede concluir para esta base de datos que las principales áreas de mejora que podría tener la empresa con sus empleados son en la aprte de aydantes generales, que se encuentrán pircipalemnte inconformes con la temperatura y no creen tener buenas prestaciones. Esto puede estar haciendo que haya una rotación tan alta dentro de esta área de la empresa.

# **Bajas FORM**

```{r}
#file.choose()
```


```{r message=FALSE, warning=FALSE}
df= read_xlsx("C:\\Users\\Eduardo\\Downloads\\BDD_FORM_BAJAS_2023.xlsx")
head(df)
```

```{r message=FALSE, warning=FALSE}
summary(df)
```

```{r message=FALSE, warning=FALSE}
df <- df %>% 
  mutate(Dpto = if_else(Dpto == "Produccion Cartón MC", "Producción Cartón MC", Dpto))
```

## Bajas por Departamento

```{r message=FALSE, warning=FALSE}
bajas_por_departamento <- df %>%
  group_by(Dpto) %>%
  summarise(Total_Bajas = n())

ggplot(bajas_por_departamento, aes(x = reorder(Dpto, -Total_Bajas), y = Total_Bajas, fill = Dpto)) +
  geom_bar(stat = "identity") +
  theme_minimal() +
  labs(title = "Bajas por Departamento", x = "Departamento", y = "Total de Bajas")
```

```{r message=FALSE, warning=FALSE} 
bajas_por_departamento <- df %>%
  group_by(Dpto) %>%
  summarise(Total_Bajas = n()) %>%
  filter(Total_Bajas > 1)

# Ordenamos las bajas por departamento de mayor a menor en el gráfico
ggplot(bajas_por_departamento, aes(x = reorder(Dpto, -Total_Bajas), y = Total_Bajas, fill = Dpto)) +
  geom_bar(stat = "identity") +
  theme_minimal() +
  labs(title = "Bajas por Departamento (Filtrado)", x = "Departamento", y = "Total de Bajas")

```


## **Bajas por Departamento y Género**

```{r message=FALSE, warning=FALSE}
bajas_por_departamento_genero <- df %>%
  group_by(Dpto, Género) %>%
  summarise(Total_Bajas = n())

ggplot(bajas_por_departamento_genero, aes(x = reorder(Dpto, -Total_Bajas), y = Total_Bajas, fill = Género)) +
  geom_bar(stat = "identity", position = "dodge") +
  theme_minimal() +
  labs(title = "Bajas por Departamento y Género", x = "Departamento", y = "Total de Bajas")
```

```{r message=FALSE, warning=FALSE}
bajas_por_departamento_genero <- df %>%
  group_by(Dpto, Género) %>%
  summarise(Total_Bajas = n()) %>%
  filter(Total_Bajas > 1)

ggplot(bajas_por_departamento_genero, aes(x = reorder(Dpto, -Total_Bajas), y = Total_Bajas, fill = Género)) +
  geom_bar(stat = "identity", position = "dodge") +
  theme_minimal() +
  labs(title = "Bajas por Departamento y Género (Filtrado)", x = "Departamento", y = "Total de Bajas")

```

## **Bajas por Motivo y Género**

```{r message=FALSE, warning=FALSE}
bajas_por_motivo_genero <- df %>%
  group_by(`Motivo de Baja`, Género) %>%
  summarise(Total_Bajas = n())

ggplot(bajas_por_motivo_genero, aes(x = `Motivo de Baja`, y = Total_Bajas, fill = Género)) +
  geom_bar(stat = "identity", position = "dodge") +
  theme_minimal() +
  labs(title = "Bajas por Motivo y Género", x = "Motivo de Baja", y = "Total de Bajas") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

Como podemos observar en estas gráficas, los dos departamentos donde vemos una mayor cantidad de bajas es en Producción de Cartón tanto MC como ML. Esto nos hace entender que ahí hay un problema grave y se tienen que tomar cartas en el asunto para detectarlo lo antes posible para generar alguna estrategia para abolirlo. De las 18 personas que fueron bajas de la empresa 17 fueron mujeres, algo que nos podría indicar un problema grave relacionado al tema de género.


```{r message=FALSE, warning=FALSE}
df$`Fecha de Baja` <- as.Date(df$`Fecha de Baja`, origin = "1899-12-30")

df$AñoMes <- format(df$`Fecha de Baja`, "%Y-%m")
```


## **Tendencia de Bajas a lo Largo del Tiempo**

```{r message=FALSE, warning=FALSE}
bajas_por_fecha <- df %>%
  group_by(AñoMes) %>%
  summarise(Total_Bajas = n())

ggplot(bajas_por_fecha, aes(x = AñoMes, y = Total_Bajas, group = 1)) +
  geom_line() +
  geom_point() +
  theme_minimal() +
  labs(title = "Tendencia de Bajas a lo Largo del Tiempo", x = "Año y Mes", y = "Total de Bajas") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

## *Bajas Totales por Mes**

```{r message=FALSE, warning=FALSE}

df$`Fecha de Baja` <- as.Date(df$`Fecha de Baja`, origin = "1899-12-30")

bajas_por_mes <- df %>%
  mutate(Mes = format(`Fecha de Baja`, "%B")) %>%
  group_by(Mes) %>%
  summarise(Total_Bajas = n())

meses <- format(seq(as.Date("2000-01-01"), as.Date("2000-12-01"), by = "month"), "%B")
bajas_por_mes$Mes <- factor(bajas_por_mes$Mes, levels = meses)

# Ahora ordenamos los datos para el gráfico
bajas_por_mes <- bajas_por_mes %>%
  mutate(Mes = reorder(Mes, -Total_Bajas))

# Gráfico de barras mostrando las bajas totales por mes, ordenadas de mayor a menor
ggplot(bajas_por_mes, aes(x = Mes, y = Total_Bajas, fill = Mes)) +
  geom_bar(stat = "identity") +
  theme_minimal() +
  labs(title = "Bajas Totales por Mes Ordenadas", x = "Mes", y = "Total de Bajas")

```

A falta datos de Marzo a Mayo, podemos inferir que no hubieron bajas en la empresa, sin embargo vemos un gran incremento en las bajas en el mes de junio, lo que hace mucho sentido. Esto que se observa puede ser por una razón legal en cuanto a temas de cotratos o puede tener cierta relación con un problema que pudo haber dentro de la parte de producción de cartón, pues la mayoría de estas bajas en el mes fueron de igual manera por esta razón. Se debe de realizar un análisis a mayor profundidad para entender de una mejor forma.


```{r}
bajas_por_estado_civil <- df %>%
  group_by(`Estado Civil`) %>%
  summarise(Total_Bajas = n()) %>%
  mutate(`Estado Civil` = reorder(`Estado Civil`, -Total_Bajas))

ggplot(bajas_por_estado_civil, aes(x = `Estado Civil`, y = Total_Bajas, fill = `Estado Civil`)) +
  geom_bar(stat = "identity") +
  theme_minimal() +
  labs(title = "Bajas por Estado Civil", x = "Estado Civil", y = "Total de Bajas") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```



##Referencias 

#1. *D&B Hoovers is Your Sales Accelerator -- Dun & Bradstreet*. (s. f.). Recuperado 16 de marzo de 2024, de <https://www.dnb.com/products/dnb-hoovers.html> 

#2. *World Bank Group - International Development, Poverty, & Sustainability*. (s. f.). World Bank. Recuperado 16 de marzo de 2024, de <https://www.worldbank.org/en/home> 

#3. *Smithers - Innovate with confidence*. (s. f.). Smithers. Recuperado 16 de marzo de 2024, de <https://www.smithers.com/home> 

#4. *Statista. (s. f.). Statista - the statistics portal*. Recuperado 16 de marzo de 2024, de <https://www.statista.com/> 

#5. *MexicoIndustry. (s. f.). *Incrementará 8% el sector automotriz en 2024*. MexicoIndustry. Recuperado 16 de marzo de 2024, de <https://mexicoindustry.com/noticia/incrementara-8-el-sector-automotriz-en-2024> 

#6. *Newsroom Infobae. (2023, 12 abril). Industria automotriz en México espera más empleos por electromovilidad. *Infobae*. Recuperado 16 de marzo de 2024, de <https://www.infobae.com/america/agencias/2023/04/12/industria-automotriz-en-mexico-espera-mas-empleos-por-electromovilidad/>
